{
  "scenario_id": "unit_test_telegram_buttons",
  "name": "Unit Test: Telegram Buttons with Input Handling",
  "description": "Tests telegram buttons sending and callback handling.",
  "version": "1.0",
  "initial_context": {
    "user_id": "tg_button_tester",
    "test_stage": "start"
  },
  "steps": [
    {
      "id": "send_question_with_buttons",
      "type": "telegram_send_message",
      "params": {
        "text": "üß™ Unit Test: –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É –ª—é–±–∏–º—É—é –æ–ø—Ü–∏—é:",
        "inline_keyboard": [
          [
            {"text": "‚úÖ –û–ø—Ü–∏—è A", "callback_data": "test_option_a"},
            {"text": "üî• –û–ø—Ü–∏—è B", "callback_data": "test_option_b"}
          ],
          [
            {"text": "‚ùì –ü–æ–º–æ—â—å", "callback_data": "test_help"}
          ]
        ]
      },
      "next_step": "wait_for_button_click"
    },
    {
      "id": "wait_for_button_click",
      "type": "input",
      "params": {
        "input_type": "callback_query",
        "prompt": "–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É",
        "output_var": "user_choice"
      },
      "next_step": "process_user_choice"
    },
    {
      "id": "process_user_choice",
      "type": "branch",
      "condition": "{user_choice} == 'test_option_a'",
      "true_next": "respond_option_a", 
      "false_next": "check_option_b"
    },
    {
      "id": "check_option_b",
      "type": "branch", 
      "condition": "{user_choice} == 'test_option_b'",
      "true_next": "respond_option_b",
      "false_next": "respond_help"
    },
    {
      "id": "respond_option_a",
      "type": "telegram_send_message",
      "params": {
        "text": "‚úÖ –í—ã –≤—ã–±—Ä–∞–ª–∏ –û–ø—Ü–∏—é A! Unit test –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ."
      },
      "next_step": "end_test"
    },
    {
      "id": "respond_option_b", 
      "type": "telegram_send_message",
      "params": {
        "text": "üî• –í—ã –≤—ã–±—Ä–∞–ª–∏ –û–ø—Ü–∏—é B! Unit test –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ."
      },
      "next_step": "end_test"
    },
    {
      "id": "respond_help",
      "type": "telegram_send_message", 
      "params": {
        "text": "‚ùì –í—ã –∑–∞–ø—Ä–æ—Å–∏–ª–∏ –ø–æ–º–æ—â—å. Unit test –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ."
      },
      "next_step": "end_test"
    },
    {
      "id": "end_test",
      "type": "log",
      "params": {
        "message": "Unit test –∫–Ω–æ–ø–æ–∫ Telegram –∑–∞–≤–µ—Ä—à–µ–Ω. –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_choice}",
        "level": "INFO"
      },
      "next_step": "end"
    },
    {
      "id": "end",
      "type": "end"
    }
  ]
} 