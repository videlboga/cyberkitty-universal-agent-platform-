<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>üöÄ KittyCore 3.0 - –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px; 
            background: #0f1419; 
            color: #fff; 
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #1a1f2e, #2d3748);
            border-radius: 10px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .status-card {
            background: #1a1f2e;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #0088ff;
        }
        .status-card.error {
            border-left-color: #ff5555;
        }
        .status-card.success {
            border-left-color: #50fa7b;
        }
        .main-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .panel {
            background: #1a1f2e;
            padding: 20px;
            border-radius: 10px;
        }
        button { 
            background: #0088ff; 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            margin: 5px; 
            font-size: 14px;
            transition: all 0.3s ease;
        }
        button:hover { background: #0066cc; }
        button:disabled { background: #666; cursor: not-allowed; }
        button.success { background: #50fa7b; color: #000; }
        button.error { background: #ff5555; }
        .log { 
            background: #0d1117; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0; 
            font-family: 'Courier New', monospace; 
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #30363d;
        }
        .task-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .task-form input, .task-form textarea {
            background: #0d1117;
            border: 1px solid #30363d;
            color: #fff;
            padding: 10px;
            border-radius: 6px;
            font-family: inherit;
        }
        .task-form textarea {
            min-height: 100px;
            resize: vertical;
        }
        .task-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .task-item {
            background: #0d1117;
            padding: 10px;
            margin: 5px 0;
            border-radius: 6px;
            border-left: 3px solid #0088ff;
        }
        .task-item.completed {
            border-left-color: #50fa7b;
        }
        .task-item.error {
            border-left-color: #ff5555;
        }
        .websocket-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
        }
        .websocket-status.connected {
            background: #50fa7b;
            color: #000;
        }
        .websocket-status.disconnected {
            background: #ff5555;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ KittyCore 3.0 - –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã</h1>
            <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–º–æ—Ä–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É—é—â–µ–π—Å—è –∞–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã</p>
        </div>

        <div class="websocket-status disconnected" id="wsStatus">
            üî¥ WebSocket: –û—Ç–∫–ª—é—á–µ–Ω
        </div>

        <div class="status-grid">
            <div class="status-card" id="apiStatus">
                <h3>üåê API –°—Ç–∞—Ç—É—Å</h3>
                <div id="apiStatusText">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
            </div>
            <div class="status-card" id="systemStatus">
                <h3>‚ö° –°–∏—Å—Ç–µ–º–∞</h3>
                <div id="systemStatusText">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
            </div>
        </div>

        <div class="main-section">
            <div class="panel">
                <h2>üìù –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h2>
                <div class="task-form">
                    <input type="text" id="taskTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" />
                    <textarea id="taskDescription" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏..."></textarea>
                    <button id="submitTask">‚ö° –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É –∞–≥–µ–Ω—Ç–∞–º</button>
                </div>
            </div>

            <div class="panel">
                <h2>üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</h2>
                <button id="checkAPI">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API</button>
                <button id="connectWS">üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å WebSocket</button>
                <button id="clearLogs">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
            </div>
        </div>

        <div class="panel">
            <h2>üìã –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
            <div id="log" class="log">–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è...</div>
        </div>
    </div>

    <script>
        class KittyCoreTestSystem {
            constructor() {
                this.apiUrl = 'http://localhost:8003';
                this.websocket = null;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.log('üöÄ –°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                this.checkAPI();
            }

            setupEventListeners() {
                document.getElementById('submitTask').addEventListener('click', () => this.submitTask());
                document.getElementById('checkAPI').addEventListener('click', () => this.checkAPI());
                document.getElementById('connectWS').addEventListener('click', () => this.connectWebSocket());
                document.getElementById('clearLogs').addEventListener('click', () => this.clearLogs());
            }

            log(message) {
                const logEl = document.getElementById('log');
                const time = new Date().toLocaleTimeString();
                logEl.innerHTML += `<br/>[${time}] ${message}`;
                logEl.scrollTop = logEl.scrollHeight;
            }

            updateStatus(elementId, text, type = 'info') {
                const element = document.getElementById(elementId);
                element.className = `status-card ${type}`;
                element.querySelector('div').textContent = text;
            }

            async checkAPI() {
                this.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API...');
                try {
                    const response = await fetch(`${this.apiUrl}/api/status`);
                    if (response.ok) {
                        const data = await response.json();
                        this.log(`‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω: ${data.status} v${data.version}`);
                        this.updateStatus('apiStatus', `‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω v${data.version}`, 'success');
                        return true;
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    this.log(`‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}`);
                    this.updateStatus('apiStatus', `‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}`, 'error');
                    return false;
                }
            }

            async submitTask() {
                const title = document.getElementById('taskTitle').value;
                const description = document.getElementById('taskDescription').value;

                if (!title || !description) {
                    this.log('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏');
                    return;
                }

                this.log(`üìù –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á—É: ${title}`);
                
                const task = {
                    id: `task_${Date.now()}`,
                    title,
                    description,
                    priority: 'medium',
                    status: 'pending',
                    created_at: new Date().toISOString()
                };

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ WebSocket –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
                if (this.websocket && this.websocket.readyState === WebSocket.OPEN) {
                    this.websocket.send(JSON.stringify({
                        type: 'task',
                        data: task
                    }));
                    this.log(`üöÄ –ó–∞–¥–∞—á–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ WebSocket: ${task.id}`);
                } else {
                    this.log(`üìù –ó–∞–¥–∞—á–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ: ${task.id}`);
                }

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDescription').value = '';
            }

            connectWebSocket() {
                this.log('üîó –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WebSocket...');
                try {
                    this.websocket = new WebSocket(`ws://localhost:8003/ws`);
                    
                    this.websocket.onopen = () => {
                        this.log('‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω');
                        document.getElementById('wsStatus').textContent = 'üü¢ WebSocket: –ü–æ–¥–∫–ª—é—á–µ–Ω';
                        document.getElementById('wsStatus').className = 'websocket-status connected';
                    };

                    this.websocket.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.log(`üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${JSON.stringify(data)}`);
                    };

                    this.websocket.onclose = () => {
                        this.log('üî¥ WebSocket –æ—Ç–∫–ª—é—á–µ–Ω');
                        document.getElementById('wsStatus').textContent = 'üî¥ WebSocket: –û—Ç–∫–ª—é—á–µ–Ω';
                        document.getElementById('wsStatus').className = 'websocket-status disconnected';
                    };

                    this.websocket.onerror = (error) => {
                        this.log(`‚ùå –û—à–∏–±–∫–∞ WebSocket: ${error}`);
                    };
                } catch (error) {
                    this.log(`‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ WebSocket: ${error}`);
                }
            }

            clearLogs() {
                document.getElementById('log').innerHTML = '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã...';
                this.log('üßπ –õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É
        const kittyCoreTest = new KittyCoreTestSystem();
    </script>
</body>
</html> 