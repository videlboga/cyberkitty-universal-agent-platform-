scenario_id: mr_ontobot_diagnostic_ya_ya
name: "OntoBot –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–Ø"
description: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤ –≤ –æ–±–ª–∞—Å—Ç–∏ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏"
initial_context:
  bot_name: "mr_ontobot"
  current_stage: "diagnostic_ya_ya"

steps:
  - id: start
    type: start
    params:
      message: "üéØ **–≠—Ç–∞–ø 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–Ø**"
    next_step: send_ya_ya_video

  - id: send_ya_ya_video
    type: channel_action
    params:
      action: copy_message
      chat_id: "{chat_id}"
      from_chat_id: "-1002614708769"
      message_id: 4
      disable_notification: true
    next_step: show_ya_ya_options

  - id: show_ya_ya_options
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "üìù **–ü–æ—Å–ª–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:**"
      reply_markup:
        inline_keyboard:
          - - text: "üëÅÔ∏è –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä—ã –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤"
              callback_data: "view_ya_ya_examples"
          - - text: "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã"
              callback_data: "write_ya_ya_viruses"
    next_step: wait_for_ya_ya_choice

  - id: wait_for_ya_ya_choice
    type: input
    params:
      input_type: "callback_query"
      expected_callbacks: ["view_ya_ya_examples", "write_ya_ya_viruses"]
      timeout: 3600
    next_step: handle_ya_ya_choice

  - id: handle_ya_ya_choice
    type: branch
    params:
      condition: "{callback_data}"
      branches:
        "view_ya_ya_examples": show_ya_ya_examples
        "write_ya_ya_viruses": ask_ya_ya_response
    next_step: end

  - id: show_ya_ya_examples
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "üëÅÔ∏è **–ü—Ä–∏–º–µ—Ä—ã –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤ –Ø-–Ø:**\n\n‚Ä¢ \"–Ø –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–Ω—ã–π\"\n‚Ä¢ \"–Ø –Ω–µ –∑–∞—Å–ª—É–∂–∏–≤–∞—é —É—Å–ø–µ—Ö–∞\"\n‚Ä¢ \"–Ø —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–π/–º–æ–ª–æ–¥–æ–π\"\n‚Ä¢ \"–£ –º–µ–Ω—è –Ω–µ—Ç –Ω—É–∂–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤\"\n‚Ä¢ \"–Ø –Ω–µ —Ç–∞–∫–æ–π –∫–∞–∫ –≤—Å–µ\"\n\nüí° *–£–∑–Ω–∞–ª–∏ —Å–µ–±—è? –¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏!*"
      reply_markup:
        inline_keyboard:
          - - text: "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã"
              callback_data: "write_ya_ya_viruses"
    next_step: wait_write_ya_ya

  - id: wait_write_ya_ya
    type: input
    params:
      input_type: "callback_query"
      expected_callbacks: ["write_ya_ya_viruses"]
      timeout: 3600
    next_step: ask_ya_ya_response

  - id: ask_ya_ya_response
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "‚úçÔ∏è **–û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã –≤ –æ–±–ª–∞—Å—Ç–∏ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∏**\n\n–ù–∞–ø—Ä–∏–º–µ—Ä:\n‚Ä¢ –ß—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Å–µ–±–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–≥–æ?\n‚Ä¢ –ö–∞–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —É–±–µ–∂–¥–µ–Ω–∏—è —É –≤–∞—Å –µ—Å—Ç—å?\n‚Ä¢ –í —á–µ–º –≤—ã —Å–µ–±—è –æ–±–≤–∏–Ω—è–µ—Ç–µ?\n\n*–ë—É–¥—å—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω—ã - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ.*"
    next_step: wait_ya_ya_response

  - id: wait_ya_ya_response
    type: input
    params:
      input_type: "text"
      timeout: 3600
    next_step: save_ya_ya_response

  - id: save_ya_ya_response
    type: mongo_upsert_document
    params:
      collection: "ontobot_responses"
      filter:
        user_id: "{user_id}"
        bot_name: "mr_ontobot"
      document:
        user_id: "{user_id}"
        bot_name: "mr_ontobot"
        ya_ya_response: "{user_input}"
        telegram_username: "{telegram_username}"
        telegram_first_name: "{telegram_first_name}"
        updated_at: "{current_datetime}"
      output_var: "save_response_result"
    next_step: switch_to_ya_delo

  - id: switch_to_ya_delo
    type: switch_scenario
    params:
      scenario_id: "mr_ontobot_diagnostic_ya_delo"
      context_merge: true
    next_step: end

  - id: end
    type: end
    params:
      message: "–≠—Ç–∞–ø –Ø-–Ø –∑–∞–≤–µ—Ä—à–µ–Ω" 