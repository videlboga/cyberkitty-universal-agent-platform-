scenario_id: likeprovodnik_init
description: "–õ–∞–π–∫–ü—Ä–æ–≤–æ–¥–Ω–∏–∫ - –ì–ª–∞–≤–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è"
version: "1.0"

initial_context:
  system_name: "–õ–∞–π–∫–ü—Ä–æ–≤–æ–¥–Ω–∏–∫"
  version: "1.0"

steps:
  - id: start
    type: start
    next_step: welcome_message

  - id: welcome_message
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        ü§ñ **–ü—Ä–∏–≤–µ—Ç! –Ø –õ–∞–π–∫–ü—Ä–æ–≤–æ–¥–Ω–∏–∫** ‚Äî —Ç–≤–æ–π AI-–ø–æ–º–æ—â–Ω–∏–∫ –≤ –º–∏—Ä–µ –±–∏–∑–Ω–µ—Å–∞ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π!

        ‚ú® **–ß—Ç–æ —è —É–º–µ—é:**
        üéØ **AI-–ü—É—Ç—å** ‚Äî —Å–æ–∑–¥–∞—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –æ–±—É—á–µ–Ω–∏—è
        üí° **–õ–∞–π—Ñ—Ö–∞–∫–∏** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É—é –±–∏–∑–Ω–µ—Å-—Å–æ–≤–µ—Ç—ã —Å –ò–ò
        üë®‚Äçüè´ **–ù–∞—Å—Ç–∞–≤–Ω–∏–∫** ‚Äî –æ—Ç–≤–µ—á–∞—é –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∫—É—Ä—Å–∞–º
        üß† **–ù–µ–π—Ä–æ–≠–∫—Å–ø–µ—Ä—Ç** ‚Äî —Ä–µ—à–∞—é —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—à–∞–≥–æ–≤–æ
        üßò **AI-–ö–æ—É—á** ‚Äî –ø–æ–º–æ–≥–∞—é —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π –∏ —Ä–µ—Ñ–ª–µ–∫—Å–∏–µ–π
        üì∞ **i–î–∞–π–¥–∂–µ—Å—Ç** ‚Äî –Ω–æ–≤–æ—Å—Ç–∏ –ò–ò –∑–∞ –Ω–µ–¥–µ–ª—é

        üí¨ **–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —á—Ç–æ —Ç–µ–±—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç!**
      parse_mode: HTML
    next_step: load_user_profile

  - id: load_user_profile
    type: mongo_find_one_document
    params:
      collection: users
      filter:
        user_id: "{user_id}"
      output_var: user_profile
    next_step: check_user_exists

  - id: check_user_exists
    type: branch
    params:
      conditions:
        - condition: "not context.get('user_profile') or not context.get('user_profile', {}).get('onboarding_completed')"
          next_step: start_onboarding
      default_next_step: go_to_router

  - id: start_onboarding
    type: switch_scenario
    params:
      target_scenario: ai_path_onboarding_flow
      preserve_context: true
    next_step: mark_onboarding_complete

  - id: mark_onboarding_complete
    type: mongo_upsert_document
    params:
      collection: users
      filter:
        user_id: "{user_id}"
      document:
        user_id: "{user_id}"
        chat_id: "{chat_id}"
        onboarding_completed: true
        onboarding_date: "{current_timestamp}"
        user_niche: "{user_niche}"
        user_income_a: "{user_income_a}"
        user_income_b: "{user_income_b}"
        user_time: "{user_time}"
        user_barriers: "{user_barriers}"
        user_ai_tasks: "{user_ai_tasks}"
        user_it_level: "{user_it_level}"
        user_results: "{user_results}"
        learning_plan: "{learning_plan}"
    next_step: go_to_router

  - id: go_to_router
    type: switch_scenario
    params:
      target_scenario: likeprovodnik_main_router_new
      preserve_context: true
    next_step: end

  - id: end
    type: end 