scenario_id: lifehack_generator_flow_v3
description: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ª–∞–π—Ñ—Ö–∞–∫–æ–≤ v3.0 —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –≤ —Ä–æ—É—Ç–µ—Ä"
version: "3.0"

initial_context:
  module_name: "üí° –õ–∞–π—Ñ—Ö–∞–∫–∏"

steps:
  - id: start
    type: start
    next_step: welcome_to_lifehacks

  - id: welcome_to_lifehacks
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        üí° **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–æ–¥—É–ª—å –õ–∞–π—Ñ—Ö–∞–∫–∏!**
        
        –Ø –≥–µ–Ω–µ—Ä–∏—Ä—É—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å–æ–≤–µ—Ç—ã —Å –ø–æ–º–æ—â—å—é –ò–ò, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ç–≤–æ–µ–π –Ω–∏—à–µ –∏ —Ü–µ–ª—è—Ö.
        
        üìù **–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –∑–∞–ø—Ä–æ—Å** –∏–ª–∏ –≤—ã–±–µ—Ä–∏ –≥–æ—Ç–æ–≤—É—é —Ç–µ–º—É:
      parse_mode: HTML
    next_step: show_lifehack_menu

  - id: show_lifehack_menu
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: |
        üéØ **–í—ã–±–µ—Ä–∏ —Ç–µ–º—É –¥–ª—è –ª–∞–π—Ñ—Ö–∞–∫–∞:**
      buttons:
        - - text: "üí∞ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞"
            callback_data: "lifehack_income"
          - text: "‚è∞ –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏"
            callback_data: "lifehack_time"
        - - text: "ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å –ò–ò"
            callback_data: "lifehack_ai"
          - text: "üìà –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞"
            callback_data: "lifehack_marketing"
        - - text: "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
            callback_data: "return_to_router"
    next_step: handle_lifehack_choice

  - id: handle_lifehack_choice
    type: input
    params:
      waiting_for: callback_query
      timeout_seconds: 300
      timeout_step: show_lifehack_menu
    next_step: process_lifehack_choice

  - id: process_lifehack_choice
    type: branch
    params:
      conditions:
        - condition: "context.get('callback_data') == 'return_to_router'"
          next_step: go_to_router
        - condition: "context.get('callback_data') == 'lifehack_income'"
          next_step: generate_income_lifehack
        - condition: "context.get('callback_data') == 'lifehack_time'"
          next_step: generate_time_lifehack
        - condition: "context.get('callback_data') == 'lifehack_ai'"
          next_step: generate_ai_lifehack
        - condition: "context.get('callback_data') == 'lifehack_marketing'"
          next_step: generate_marketing_lifehack
      default_next_step: generate_custom_lifehack

  - id: generate_income_lifehack
    type: llm_query
    params:
      provider: "anthropic"
      model: "claude-3-haiku-20240307"
      prompt: |
        –¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –±–∏–∑–Ω–µ—Å-–ª–∞–π—Ñ—Ö–∞–∫–∞–º. –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç –ø–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –¥–æ—Ö–æ–¥–∞.
        
        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        - –ù–∏—à–∞: {user_niche}
        - –¢–µ–∫—É—â–∏–π –¥–æ—Ö–æ–¥: {user_income_a}-{user_income_b}
        - –í—Ä–µ–º—è: {user_time}
        - –£—Ä–æ–≤–µ–Ω—å IT: {user_it_level}
        
        –°–æ–∑–¥–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –ø—Ä–∏–º–µ–Ω–∏–º—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –¥–ª—è –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –¥–æ—Ö–æ–¥–∞.
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        üí∞ **–õ–∞–π—Ñ—Ö–∞–∫: [–Ω–∞–∑–≤–∞–Ω–∏–µ]**
        
        üéØ **–°—É—Ç—å:** [1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]
        
        üìã **–®–∞–≥–∏:**
        1. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        2. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        3. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        
        ‚ö° **–†–µ–∑—É–ª—å—Ç–∞—Ç:** [–æ–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç]
        
        –°—Ç–∏–ª—å: –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.
      output_var: lifehack_content
    next_step: send_lifehack

  - id: generate_time_lifehack
    type: llm_query
    params:
      provider: "anthropic"
      model: "claude-3-haiku-20240307"
      prompt: |
        –¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç –ø–æ —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏.
        
        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        - –ù–∏—à–∞: {user_niche}
        - –í—Ä–µ–º—è –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ: {user_time}
        - –ë–∞—Ä—å–µ—Ä—ã: {user_barriers}
        - –£—Ä–æ–≤–µ–Ω—å IT: {user_it_level}
        
        –°–æ–∑–¥–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –ø–æ —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        ‚è∞ **–õ–∞–π—Ñ—Ö–∞–∫: [–Ω–∞–∑–≤–∞–Ω–∏–µ]**
        
        üéØ **–°—É—Ç—å:** [1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]
        
        üìã **–®–∞–≥–∏:**
        1. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        2. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥] 
        3. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        
        ‚ö° **–†–µ–∑—É–ª—å—Ç–∞—Ç:** [—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—ç–∫–æ–Ω–æ–º–∏—Ç]
        
        –°—Ç–∏–ª—å: –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.
      output_var: lifehack_content
    next_step: send_lifehack

  - id: generate_ai_lifehack
    type: llm_query
    params:
      provider: "anthropic"
      model: "claude-3-haiku-20240307"
      prompt: |
        –¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é –ò–ò –≤ –±–∏–∑–Ω–µ—Å. –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å –ò–ò.
        
        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        - –ù–∏—à–∞: {user_niche}
        - –ó–∞–¥–∞—á–∏ –¥–ª—è –ò–ò: {user_ai_tasks}
        - –£—Ä–æ–≤–µ–Ω—å IT: {user_it_level}
        - –ñ–µ–ª–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: {user_results}
        
        –°–æ–∑–¥–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å –ò–ò –¥–ª—è –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        ü§ñ **–õ–∞–π—Ñ—Ö–∞–∫: [–Ω–∞–∑–≤–∞–Ω–∏–µ]**
        
        üéØ **–°—É—Ç—å:** [1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]
        
        üìã **–®–∞–≥–∏:**
        1. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        2. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        3. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        
        ‚ö° **–†–µ–∑—É–ª—å—Ç–∞—Ç:** [–∫–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç]
        
        –°—Ç–∏–ª—å: –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.
      output_var: lifehack_content
    next_step: send_lifehack

  - id: generate_marketing_lifehack
    type: llm_query
    params:
      provider: "anthropic"
      model: "claude-3-haiku-20240307"
      prompt: |
        –¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É. –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç –ø–æ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—é –±–∏–∑–Ω–µ—Å–∞.
        
        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        - –ù–∏—à–∞: {user_niche}
        - –î–æ—Ö–æ–¥: {user_income_a}-{user_income_b}
        - –ñ–µ–ª–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: {user_results}
        - –£—Ä–æ–≤–µ–Ω—å IT: {user_it_level}
        
        –°–æ–∑–¥–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –ø–æ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—é –±–∏–∑–Ω–µ—Å–∞ –¥–ª—è –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        üìà **–õ–∞–π—Ñ—Ö–∞–∫: [–Ω–∞–∑–≤–∞–Ω–∏–µ]**
        
        üéØ **–°—É—Ç—å:** [1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]
        
        üìã **–®–∞–≥–∏:**
        1. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        2. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        3. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        
        ‚ö° **–†–µ–∑—É–ª—å—Ç–∞—Ç:** [–æ–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è]
        
        –°—Ç–∏–ª—å: –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.
      output_var: lifehack_content
    next_step: send_lifehack

  - id: generate_custom_lifehack
    type: llm_query
    params:
      provider: "anthropic"
      model: "claude-3-haiku-20240307"
      prompt: |
        –¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –±–∏–∑–Ω–µ—Å-–ª–∞–π—Ñ—Ö–∞–∫–∞–º. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª: "{message_text}"
        
        –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        - –ù–∏—à–∞: {user_niche}
        - –î–æ—Ö–æ–¥: {user_income_a}-{user_income_b}
        - –í—Ä–µ–º—è: {user_time}
        - –ë–∞—Ä—å–µ—Ä—ã: {user_barriers}
        - –£—Ä–æ–≤–µ–Ω—å IT: {user_it_level}
        - –¶–µ–ª–∏: {user_results}
        
        –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        üí° **–õ–∞–π—Ñ—Ö–∞–∫: [–Ω–∞–∑–≤–∞–Ω–∏–µ]**
        
        üéØ **–°—É—Ç—å:** [1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]
        
        üìã **–®–∞–≥–∏:**
        1. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        2. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        3. [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥]
        
        ‚ö° **–†–µ–∑—É–ª—å—Ç–∞—Ç:** [–æ–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç]
        
        –°—Ç–∏–ª—å: –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏.
      output_var: lifehack_content
    next_step: send_lifehack

  - id: send_lifehack
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "{lifehack_content}"
      parse_mode: HTML
    next_step: lifehack_complete

  # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–æ–¥—É–ª—è —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –≤ —Ä–æ—É—Ç–µ—Ä
  - id: lifehack_complete
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: |
        ‚úÖ **–õ–∞–π—Ñ—Ö–∞–∫ –≥–æ—Ç–æ–≤!**
        
        –ß—Ç–æ –¥–∞–ª—å—à–µ?
      buttons:
        - - text: "üí° –ï—â–µ –ª–∞–π—Ñ—Ö–∞–∫"
            callback_data: "another_lifehack"
          - text: "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
            callback_data: "return_to_router"
        - - text: "‚ùì –î—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏"
            callback_data: "explain_modules"
    next_step: handle_complete_choice

  - id: handle_complete_choice
    type: input
    params:
      waiting_for: callback_query
      timeout_seconds: 300
      timeout_step: lifehack_complete
    next_step: process_complete_choice

  - id: process_complete_choice
    type: branch
    params:
      conditions:
        - condition: "context.get('callback_data') == 'return_to_router'"
          next_step: go_to_router
        - condition: "context.get('callback_data') == 'another_lifehack'"
          next_step: show_lifehack_menu
        - condition: "context.get('callback_data') == 'explain_modules'"
          next_step: go_to_router
      default_next_step: go_to_router

  - id: go_to_router
    type: switch_scenario
    params:
      target_scenario: likeprovodnik_main_router_new
      preserve_context: true
    next_step: end

  - id: end
    type: end 