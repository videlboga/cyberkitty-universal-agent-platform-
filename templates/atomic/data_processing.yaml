# üîÑ –ê–¢–û–ú–ê–†–ù–´–ô –ë–õ–û–ö: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –±–ª–æ–∫ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

atomic_template: "data_processing"
version: "1.0"
description: "–û–±—Ä–∞–±–æ—Ç–∫–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö"
author: "Universal Agent System"

# ===== –ü–ê–†–ê–ú–ï–¢–†–´ =====
parameters:
  input_data:
    type: "any"
    description: "–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏"
    required: true
  
  operation:
    type: "string"
    description: "–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: format, validate, transform, filter, aggregate"
    required: true
  
  format_template:
    type: "string"
    description: "–®–∞–±–ª–æ–Ω —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–ª—è operation=format)"
    default: ""
  
  validation_rules:
    type: "object"
    description: "–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–¥–ª—è operation=validate)"
    default: {}
  
  transform_function:
    type: "string"
    description: "–§—É–Ω–∫—Ü–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–¥–ª—è operation=transform)"
    default: ""
  
  filter_condition:
    type: "string"
    description: "–£—Å–ª–æ–≤–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–¥–ª—è operation=filter)"
    default: ""
  
  aggregate_function:
    type: "string"
    description: "–§—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏: sum, count, avg, min, max (–¥–ª—è operation=aggregate)"
    default: "count"
  
  output_var:
    type: "string"
    description: "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"
    default: "processed_data"
  
  error_handling:
    type: "string"
    description: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: strict, lenient, ignore"
    default: "strict"

# ===== –®–ê–ì–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø =====
steps:
  - id: "processing_start"
    type: "log_message"
    params:
      message: "üîÑ –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö: {operation}"
      level: "INFO"
    next_step: "choose_operation"
  
  - id: "choose_operation"
    type: "branch"
    params:
      variable: "operation"
      branches:
        "format": "format_data"
        "validate": "validate_data"
        "transform": "transform_data"
        "filter": "filter_data"
        "aggregate": "aggregate_data"
      default: "unsupported_operation"
  
  # ===== –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï =====
  - id: "format_data"
    type: "action"
    params:
      action_type: "format_data"
      input_data: "{input_data}"
      template: "{format_template}"
      output_var: "{output_var}"
      error_handling: "{error_handling}"
    next_step: "processing_end"
  
  # ===== –í–ê–õ–ò–î–ê–¶–ò–Ø =====
  - id: "validate_data"
    type: "action"
    params:
      action_type: "validate_data"
      input_data: "{input_data}"
      rules: "{validation_rules}"
      output_var: "{output_var}"
      error_handling: "{error_handling}"
    next_step: "processing_end"
  
  # ===== –¢–†–ê–ù–°–§–û–†–ú–ê–¶–ò–Ø =====
  - id: "transform_data"
    type: "action"
    params:
      action_type: "transform_data"
      input_data: "{input_data}"
      function: "{transform_function}"
      output_var: "{output_var}"
      error_handling: "{error_handling}"
    next_step: "processing_end"
  
  # ===== –§–ò–õ–¨–¢–†–ê–¶–ò–Ø =====
  - id: "filter_data"
    type: "action"
    params:
      action_type: "filter_data"
      input_data: "{input_data}"
      condition: "{filter_condition}"
      output_var: "{output_var}"
      error_handling: "{error_handling}"
    next_step: "processing_end"
  
  # ===== –ê–ì–†–ï–ì–ê–¶–ò–Ø =====
  - id: "aggregate_data"
    type: "action"
    params:
      action_type: "aggregate_data"
      input_data: "{input_data}"
      function: "{aggregate_function}"
      output_var: "{output_var}"
      error_handling: "{error_handling}"
    next_step: "processing_end"
  
  # ===== –û–®–ò–ë–ö–ò =====
  - id: "unsupported_operation"
    type: "action"
    params:
      action_type: "update_context"
      updates:
        processing_error: "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è: {operation}"
        processing_failed: true
    next_step: "processing_end"
  
  - id: "processing_end"
    type: "log_message"
    params:
      message: "‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞: {{{output_var}}}"
      level: "INFO"

# ===== –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø =====
examples:
  - name: "–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è"
    parameters:
      input_data: 
        name: "–ò–≤–∞–Ω"
        age: 25
        city: "–ú–æ—Å–∫–≤–∞"
      operation: "format"
      format_template: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {name}, {age} –ª–µ—Ç, –∏–∑ –≥–æ—Ä–æ–¥–∞ {city}"
      output_var: "formatted_message"

  - name: "–í–∞–ª–∏–¥–∞—Ü–∏—è email"
    parameters:
      input_data: "user@example.com"
      operation: "validate"
      validation_rules:
        type: "email"
        required: true
      output_var: "email_valid"

  - name: "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä"
    parameters:
      input_data: "hello world"
      operation: "transform"
      transform_function: "upper"
      output_var: "uppercase_text"

  - name: "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ —á–∏—Å–µ–ª"
    parameters:
      input_data: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
      operation: "filter"
      filter_condition: "x > 5"
      output_var: "filtered_numbers"

  - name: "–ü–æ–¥—Å—á–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤"
    parameters:
      input_data: ["apple", "banana", "orange", "apple", "banana"]
      operation: "aggregate"
      aggregate_function: "count"
      output_var: "items_count"

# ===== –¢–†–ï–ë–û–í–ê–ù–ò–Ø =====
requirements:
  plugins: []  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  
  context_variables:
    - "input_data"      # –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

# ===== –†–ï–ó–£–õ–¨–¢–ê–¢ =====
output:
  context_updates:
    - "{output_var}": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
    - "processing_completed": "true –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ"
    - "processing_failed": "true –µ—Å–ª–∏ –æ—à–∏–±–∫–∞"
    - "processing_error": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å" 