# üéØ –ò–¢–û–ì–û–í–û–ï –†–ï–ó–Æ–ú–ï: –°–¶–ï–ù–ê–†–ò–ò ONTOBOT –° –†–ï–ê–õ–¨–ù–´–ú–ò ID

## üìã –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### 1. üîç –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö ID —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–∞
- **–ö–∞–Ω–∞–ª OntoBot**: `-1002614708769`
- **–¢–æ–∫–µ–Ω –±–æ—Ç–∞**: `7907324843:AAFjN2H4ud2X6rm7XShrmS3G1l1JnCo4feM`
- **–ù–∞–π–¥–µ–Ω–Ω—ã–µ ID —Å–æ–æ–±—â–µ–Ω–∏–π**: 2, 4, 5, 6, 7, 8, 9, 10

### 2. üì∫ –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ —Å —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
```yaml
mr_ontobot_main_router: message_id = 2        # –ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤"
mr_ontobot_diagnostic_ya_ya: message_id = 4   # –í—Ç–æ—Ä–æ–µ –≤–∏–¥–µ–æ "–ó–∞–¥–∞–Ω–∏–µ –Ø-–Ø"
mr_ontobot_diagnostic_ya_delo: message_id = 5 # –¢—Ä–µ—Ç—å–µ –≤–∏–¥–µ–æ "–ó–∞–¥–∞–Ω–∏–µ –Ø-–î–µ–ª–æ"  
mr_ontobot_diagnostic_ya_relations: message_id = 6 # –ß–µ—Ç–≤–µ—Ä—Ç–æ–µ –≤–∏–¥–µ–æ "–ó–∞–¥–∞–Ω–∏–µ –Ø-–û—Ç–Ω–æ—à–µ–Ω–∏—è"
```

### 3. üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
**–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**
- ‚ùå `conditional_execute` ‚Üí ‚úÖ `branch` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø —à–∞–≥–∞)
- ‚ùå `"{field}"` ‚Üí ‚úÖ `"context.get('field')"` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —É—Å–ª–æ–≤–∏–π)
- ‚ùå –§—Ä–∞–≥–º–µ–Ω—Ç—ã YAML ‚Üí ‚úÖ –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### 4. üìö –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### `mr_ontobot_main_router.yaml` (–ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä)
- **–§—É–Ω–∫—Ü–∏—è**: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –ø–æ–∫–∞–∑ –≤–∏–¥–µ–æ, —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
- **–í–∏–¥–µ–æ**: ID 2 (–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤)
- **–ü–µ—Ä–µ—Ö–æ–¥—ã**: –ù–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –Ø-–Ø –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–∏ –≤–≤–æ–¥–∞

#### `mr_ontobot_diagnostic_ya_ya.yaml` (–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–Ø)
- **–§—É–Ω–∫—Ü–∏—è**: –ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ - –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Å–µ–±–µ
- **–í–∏–¥–µ–æ**: ID 4 (–ó–∞–¥–∞–Ω–∏–µ –Ø-–Ø)
- **–õ–æ–≥–∏–∫–∞**: –ü—Ä–∏–º–µ—Ä—ã ‚Üí –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ‚Üí –í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞ ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ø-–î–µ–ª–æ
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –≤ –ë–î

#### `mr_ontobot_diagnostic_ya_delo.yaml` (–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–î–µ–ª–æ)
- **–§—É–Ω–∫—Ü–∏—è**: –í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ - –∫–∞—Ä—å–µ—Ä–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- **–í–∏–¥–µ–æ**: ID 5 (–ó–∞–¥–∞–Ω–∏–µ –Ø-–î–µ–ª–æ)
- **–õ–æ–≥–∏–∫–∞**: –ü—Ä–∏–º–µ—Ä—ã ‚Üí –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ‚Üí –í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞ ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ø-–û—Ç–Ω–æ—à–µ–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –≤ –ë–î

#### `mr_ontobot_diagnostic_ya_relations.yaml` (–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–û—Ç–Ω–æ—à–µ–Ω–∏—è)
- **–§—É–Ω–∫—Ü–∏—è**: –¢—Ä–µ—Ç–∏–π —ç—Ç–∞–ø –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ - –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ª—é–¥—å–º–∏
- **–í–∏–¥–µ–æ**: ID 6 (–ó–∞–¥–∞–Ω–∏–µ –Ø-–û—Ç–Ω–æ—à–µ–Ω–∏—è)
- **–õ–æ–≥–∏–∫–∞**: –ü—Ä–∏–º–µ—Ä—ã ‚Üí –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ‚Üí –í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞ ‚Üí –ó–∞–ø—Ä–æ—Å –∫–æ–Ω—Ç–∞–∫—Ç–∞
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –≤ –ë–î

## üß™ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### MongoDB –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ **–í—Å—Ç–∞–≤–∫–∞**: –£—Å–ø–µ—à–Ω–æ (ID: 683b1c685dcc816cac29eba4)
- ‚úÖ **–ü–æ–∏—Å–∫**: –£—Å–ø–µ—à–Ω–æ (–Ω–∞–π–¥–µ–Ω 1 –¥–æ–∫—É–º–µ–Ω—Ç)
- ‚ùå **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –û—à–∏–±–∫–∞ —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º $set (–ø—Ä–æ–±–ª–µ–º–∞ API)
- ‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ**: –£—Å–ø–µ—à–Ω–æ (—É–¥–∞–ª–µ–Ω 1 –¥–æ–∫—É–º–µ–Ω—Ç)

### LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ **–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω**: API –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚ö†Ô∏è **API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω**: –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç {"error": "API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"}

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è
- ‚úÖ **–°—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**: mr_ontobot_main_router –Ω–∞–π–¥–µ–Ω –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- ‚úÖ **–î–æ—Ö–æ–¥–∏—Ç –¥–æ –æ–∂–∏–¥–∞–Ω–∏—è –≤–≤–æ–¥–∞**: –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ wait_for_diagnostic_start
- ‚ö†Ô∏è **Channel test not found**: –¢–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤)

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

```
‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: 1/3 (33.3%)
üìÅ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: 4/4 (100%)
üé¨ –í–∏–¥–µ–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: 4/4 (100%)
‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 0.03 —Å–µ–∫—É–Ω–¥
```

## üöÄ –ö–ê–ö –ó–ê–ü–£–°–ö–ê–¢–¨

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ –ë–î
```bash
python load_scenarios.py
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏
```bash
python tests/real_ontobot_tester.py
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ KittyCore API
```bash
curl -X POST http://localhost:8085/api/v1/simple/channels/telegram/execute \
  -H "Content-Type: application/json" \
  -d '{
    "scenario_id": "mr_ontobot_main_router",
    "context": {
      "user_id": "123456789",
      "chat_id": "123456789",
      "telegram_first_name": "–ò–≤–∞–Ω",
      "telegram_last_name": "–ü–µ—Ç—Ä–æ–≤"
    }
  }'
```

## üîß –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –°–¶–ï–ù–ê–†–ò–ï–í KITTYCORE

### –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
```yaml
scenario_id: "unique_scenario_name"
name: "–ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"
description: "–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è"

initial_context:
  variable1: "value1"
  variable2: "value2"

steps:
  - id: start
    type: start
    next_step: next_step_id

  - id: branch_example
    type: branch
    params:
      conditions:
        - condition: "context.get('field') == 'value'"
          next_step: step_if_true
      default_next_step: step_if_false

  - id: channel_action_example
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"
    next_step: next_step

  - id: end
    type: end
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —à–∞–≥–æ–≤
- ‚úÖ `start`, `end`, `action`, `input`, `branch`
- ‚úÖ `channel_action` (–¥–ª—è Telegram)
- ‚úÖ `switch_scenario` (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- ‚úÖ `mongo_*` (–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å MongoDB)
- ‚úÖ `llm_*` (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ò–ò)
- ‚ùå `conditional_execute` (–ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

## üìÅ –§–ê–ô–õ–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

```
scenarios/
‚îú‚îÄ‚îÄ mr_ontobot_main_router.yaml           # –ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä
‚îú‚îÄ‚îÄ mr_ontobot_diagnostic_ya_ya.yaml      # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–Ø
‚îú‚îÄ‚îÄ mr_ontobot_diagnostic_ya_delo.yaml    # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–î–µ–ª–æ
‚îî‚îÄ‚îÄ mr_ontobot_diagnostic_ya_relations.yaml # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø-–û—Ç–Ω–æ—à–µ–Ω–∏—è

tests/
‚îú‚îÄ‚îÄ real_ontobot_tester.py                # –¢–µ—Å—Ç–µ—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îú‚îÄ‚îÄ telegram_mock_server.py              # Mock Telegram API
‚îú‚îÄ‚îÄ user_simulator.py                    # –°–∏–º—É–ª—è—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ ontobot_test_runner.py               # –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã OntoBot

logs/
‚îú‚îÄ‚îÄ scenario_load_results.json           # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ real_ontobot_test_results.json       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ video_messages_results.json          # ID —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–∞
‚îî‚îÄ‚îÄ *.log                                # –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å LLM API –∫–ª—é—á** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ—Å—å–µ
2. **–°–æ–∑–¥–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**:
   - `mr_ontobot_contact_collection` (—Å–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤)
   - `mr_ontobot_dossier_feedback` (–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ—Å—å–µ)
   - `mr_ontobot_product_offer` (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞)
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π Telegram –∫–∞–Ω–∞–ª** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. **–î–æ–±–∞–≤–∏—Ç—å AmoCRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é** –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–∏–¥–æ–≤
5. **–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π E2E —Ç–µ—Å—Ç** –≤—Å–µ–π –≤–æ—Ä–æ–Ω–∫–∏

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–°–∏—Å—Ç–µ–º–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ OntoBot —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞:
- ‚úÖ –í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É KittyCore
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ ID –≤–∏–¥–µ–æ –∏–∑ –∫–∞–Ω–∞–ª–∞
- ‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ MongoDB
- ‚úÖ –ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram –±–æ—Ç–æ–º

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üöÄ 