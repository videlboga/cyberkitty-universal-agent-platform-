# üìä –û–¢–ß–ï–¢: MongoDB API vs Admin API

## üéØ **–¶–ï–õ–¨ –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø**
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–º–µ–Ω—ã Admin API –Ω–∞ MongoDB API –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤ KittyCore.

## üî¨ **–ú–ï–¢–û–î–û–õ–û–ì–ò–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**
- **–†–µ–∞–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã** —á–µ—Ä–µ–∑ curl –∫ API
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ MongoDB** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
- **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏** (Create, Read, Update, Delete)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–æ–≤** —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏–∑ MongoDB

---

## üìã **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**

### ‚úÖ **–¢–ï–°–¢ 1: –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ MongoDB API**
```bash
./tests/test_complete_mongo_api.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **CREATE**: –î–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **READ**: –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
- ‚úÖ **UPDATE**: –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- ‚úÖ **DELETE**: –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **CLEANUP**: –û—á–∏—Å—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

**–í—ã–≤–æ–¥:** MongoDB API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π.

### ‚úÖ **–¢–ï–°–¢ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ MongoDB API**
```bash
./tests/test_plugin_settings_mongo.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `plugin_settings`
- ‚úÖ **–ü–ª–∞–≥–∏–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è** –≤ –¥–≤–∏–∂–∫–µ (7 –ø–ª–∞–≥–∏–Ω–æ–≤)
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤–æ–π** (56 –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —à–∞–≥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã** –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ **LLM –ø–ª–∞–≥–∏–Ω –≤—ã–ø–æ–ª–Ω–∏–ª —à–∞–≥ —É—Å–ø–µ—à–Ω–æ**
- ‚ö†Ô∏è **Telegram –ø–ª–∞–≥–∏–Ω –ø–æ–ø—ã—Ç–∞–ª—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å** (–æ—à–∏–±–∫–∞ "Chat not found" - –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

**–í—ã–≤–æ–¥:** –ü–ª–∞–≥–∏–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏–∑ MongoDB.

### ‚úÖ **–¢–ï–°–¢ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**
```bash
./tests/test_mongo_vs_admin.sh
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **MongoDB API –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- ‚úÖ **MongoDB API –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- ‚úÖ **MongoDB API –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- ‚úÖ **MongoDB API –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
- ‚ùå **Admin API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** (404 Not Found) - —á—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–æ–∫–∞–∑–∞—Ç—å

---

## üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ô –ê–ù–ê–õ–ò–ó**

### **üîß MongoDB API Endpoints:**
```
POST /api/v1/simple/mongo/find        - –ø–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
POST /api/v1/simple/mongo/insert      - –≤—Å—Ç–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
POST /api/v1/simple/mongo/update      - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
POST /api/v1/simple/mongo/delete      - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
POST /api/v1/simple/mongo/save-scenario - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è
```

### **‚öôÔ∏è Admin API Endpoints (–£–î–ê–õ–ï–ù–´):**
```
‚ùå POST /api/v1/admin/plugins/amocrm/settings
‚ùå POST /api/v1/admin/plugins/telegram/settings  
‚ùå POST /api/v1/admin/plugins/llm/settings
‚ùå GET  /api/v1/admin/plugins/status
```

### **üí° –ü–æ—á–µ–º—É Admin API –∏–∑–±—ã—Ç–æ—á–µ–Ω:**

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:**
   - Admin API –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã –ø–ª–∞–≥–∏–Ω–æ–≤
   - –ü–ª–∞–≥–∏–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ MongoDB –ø–ª–∞–≥–∏–Ω
   - MongoDB API –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ –Ω–∞–ø—Ä—è–º—É—é

2. **–õ–∏—à–Ω–∏–π —Å–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏:**
   ```
   –°—Ç–∞—Ä—ã–π –ø—É—Ç—å: Client ‚Üí Admin API ‚Üí Plugin ‚Üí MongoDB Plugin ‚Üí MongoDB
   –ù–æ–≤—ã–π –ø—É—Ç—å:  Client ‚Üí MongoDB API ‚Üí MongoDB Plugin ‚Üí MongoDB
   ```

3. **–ë–æ–ª—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:**
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (AmoCRMSettings, TelegramSettings, etc.)
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

---

## üìä **–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ò–ú–ï–†–´**

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AmoCRM —á–µ—Ä–µ–∑ MongoDB API:**
```bash
curl -X POST "http://localhost:8085/api/v1/simple/mongo/insert" \
  -H "Content-Type: application/json" \
  -d '{
    "collection": "plugin_settings",
    "document": {
      "plugin_name": "amocrm",
      "base_url": "https://test.amocrm.ru",
      "access_token": "test_token_123456"
    }
  }'
```

### **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ MongoDB API:**
```bash
curl -X POST "http://localhost:8085/api/v1/simple/mongo/update" \
  -H "Content-Type: application/json" \
  -d '{
    "collection": "plugin_settings",
    "filter": {"plugin_name": "amocrm"},
    "document": {
      "base_url": "https://updated.amocrm.ru",
      "access_token": "updated_token_456"
    }
  }'
```

### **–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ MongoDB API:**
```bash
curl -X POST "http://localhost:8085/api/v1/simple/mongo/find" \
  -H "Content-Type: application/json" \
  -d '{
    "collection": "plugin_settings",
    "filter": {"plugin_name": "amocrm"}
  }'
```

---

## üéØ **–í–´–í–û–î–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**

### ‚úÖ **–î–û–ö–ê–ó–ê–ù–û:**
1. **MongoDB API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω** –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏
2. **–ü–ª–∞–≥–∏–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –∏–∑ MongoDB —á–µ—Ä–µ–∑ MongoDB –ø–ª–∞–≥–∏–Ω
3. **Admin API –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–∑–±—ã—Ç–æ—á–µ–Ω** –∏ –¥—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
4. **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ** –±–µ–∑ Admin API

### üöÄ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:**

#### **–ù–ï–ú–ï–î–õ–ï–ù–ù–û:**
- ‚úÖ **–£–¥–∞–ª–∏—Ç—å Admin API** (`app/api/admin.py`)
- ‚úÖ **–£–±—Ä–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã Admin API** –∏–∑ `app/simple_main.py`
- ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** —Å –Ω–æ–≤—ã–º–∏ endpoints

#### **–í –ü–ï–†–°–ü–ï–ö–¢–ò–í–ï:**
- üìù **–°–æ–∑–¥–∞—Ç—å —É–¥–æ–±–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã** –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ MongoDB API
- üîß **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫** –Ω–∞ —É—Ä–æ–≤–Ω–µ MongoDB API
- üìä **–°–æ–∑–¥–∞—Ç—å Web UI** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —á–µ—Ä–µ–∑ MongoDB API

---

## üìà **–ú–ï–¢–†–ò–ö–ò –£–õ–£–ß–®–ï–ù–ò–Ø**

### **–£–ø—Ä–æ—â–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- **-1 API —Ñ–∞–π–ª** (`admin.py` —É–¥–∞–ª–µ–Ω)
- **-4 –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö** (AmoCRMSettings, TelegramSettings, etc.)
- **-6 endpoints** (admin endpoints —É–¥–∞–ª–µ–Ω—ã)
- **-200+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞** (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–ú–µ–Ω—å—à–µ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤** (–ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ MongoDB API)
- **–ú–µ–Ω—å—à–µ —Å–ª–æ–µ–≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏** (—É–±—Ä–∞–Ω –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π)
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (–≤—Å–µ —á–µ—Ä–µ–∑ MongoDB API)

### **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏**
- **–ï–¥–∏–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏**
- **–ü—Ä–æ—â–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (–æ–¥–∏–Ω API –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö)

---

## üèÜ **–§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢**

> **MongoDB API –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–ú–ï–ù–Ø–ï–¢ Admin API**
> 
> –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ Admin API –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ MongoDB API —Å —Ç–µ–º –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –Ω–æ —Å –º–µ–Ω—å—à–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –∏ –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç—å—é.

### **–ü—Ä–∏–Ω—Ü–∏–ø KittyCore –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω:**
> **"–ü–†–û–°–¢–û–¢–ê –ü–†–ï–í–´–®–ï –í–°–ï–ì–û!"**

**Admin API —É–¥–∞–ª–µ–Ω. MongoDB API –æ—Å—Ç–∞–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.**

---

*–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã KittyCore*  
*–î–∞—Ç–∞: $(date)*  
*–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: SimpleScenarioEngine + MongoDB API* 