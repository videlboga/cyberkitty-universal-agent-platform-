# ü§ñ –ê–¢–û–ú–ê–†–ù–´–ô –ë–õ–û–ö: –ß–∞—Ç —Å LLM
# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –±–ª–æ–∫ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ —Å —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏

atomic_template: "llm_chat"
version: "1.0"
description: "–î–∏–∞–ª–æ–≥ —Å LLM –º–æ–¥–µ–ª—å—é —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏"
author: "Universal Agent System"

# ===== –ü–ê–†–ê–ú–ï–¢–†–´ =====
parameters:
  prompt:
    type: "string"
    description: "–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –º–æ–¥–µ–ª–∏"
    default: "–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É."
  
  user_message:
    type: "string"
    description: "–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
    required: true
  
  model:
    type: "string"
    description: "–ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
    default: "deepseek/deepseek-chat"
  
  max_tokens:
    type: "integer"
    description: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ"
    default: 1000
  
  temperature:
    type: "float"
    description: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (0.0-1.0)"
    default: 0.7
  
  output_var:
    type: "string"
    description: "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ LLM"
    default: "llm_response"
  
  show_typing:
    type: "boolean"
    description: "–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ –≤ Telegram"
    default: true

# ===== –®–ê–ì–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø =====
steps:
  - id: "chat_start"
    type: "log_message"
    params:
      message: "ü§ñ –ù–∞—á–∏–Ω–∞–µ–º —á–∞—Ç —Å LLM ({model})"
      level: "INFO"
    next_step: "show_typing"
  
  - id: "show_typing"
    type: "telegram_send_message"
    params:
      action: "typing"
      enabled: "{show_typing}"
    next_step: "llm_request"
    
  - id: "llm_request"
    type: "llm_query"
    params:
      prompt: "{prompt}"
      user_message: "{user_message}"
      model: "{model}"
      max_tokens: "{max_tokens}"
      temperature: "{temperature}"
      output_var: "{output_var}"
    next_step: "send_response"
  
  - id: "send_response"
    type: "telegram_send_message"
    params:
      text: "{{{output_var}}}"
      parse_mode: "Markdown"
    next_step: "chat_end"
  
  - id: "chat_end"
    type: "log_message"
    params:
      message: "‚úÖ LLM –æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"
      level: "INFO"

# ===== –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø =====
examples:
  - name: "–ü—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç"
    parameters:
      prompt: "–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ."
      user_message: "–û–±—ä—è—Å–Ω–∏ —á—Ç–æ —Ç–∞–∫–æ–µ –ò–ò"
      model: "deepseek/deepseek-chat"
      output_var: "ai_explanation"

  - name: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"
    parameters:
      prompt: "–¢—ã –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç. –ü–æ–º–æ–≥–∞–π —Å –∫–æ–¥–æ–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π."
      user_message: "{user_question}"
      model: "deepseek/deepseek-coder"
      max_tokens: 2000
      temperature: 0.3
      output_var: "tech_advice"

  - name: "–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫"
    parameters:
      prompt: "–¢—ã –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–π."
      user_message: "–ü—Ä–∏–¥—É–º–∞–π –∏–¥–µ–∏ –¥–ª—è {topic}"
      model: "openai/gpt-4"
      temperature: 0.9
      output_var: "creative_ideas"

# ===== –¢–†–ï–ë–û–í–ê–ù–ò–Ø =====
requirements:
  plugins:
    - "LLMPlugin"        # –î–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ LLM
    - "TelegramPlugin"   # –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
  
  context_variables:
    - "user_message"     # –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

# ===== –†–ï–ó–£–õ–¨–¢–ê–¢ =====
output:
  context_updates:
    - "{output_var}": "–û—Ç–≤–µ—Ç –æ—Ç LLM –º–æ–¥–µ–ª–∏"
    - "chat_completed": "true"
    - "model_used": "{model}"
    - "tokens_used": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤" 