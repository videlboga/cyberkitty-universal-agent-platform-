# üìã –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AmoCRM –ø–ª–∞–≥–∏–Ω–æ–≤

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ AmoCRM —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 5 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –¥–ª—è –ª—É—á—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–æ–¥–∞:

- **–ë–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å** - –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –∏ —Å–¥–µ–ª–∫–∞–º–∏
- **–ú–æ–¥—É–ª—å –∫–æ–º–ø–∞–Ω–∏–π** - —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏
- **–ú–æ–¥—É–ª—å –∑–∞–¥–∞—á** - –∑–∞–¥–∞—á–∏ –∏ —Å–æ–±—ã—Ç–∏—è
- **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–¥—É–ª—å** - –≤–µ–±—Ö—É–∫–∏, –≤–∏–¥–∂–µ—Ç—ã, –∑–≤–æ–Ω–∫–∏, –∫–∞—Ç–∞–ª–æ–≥–∏
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å** - –≤–æ—Ä–æ–Ω–∫–∏, –ø–æ–ª—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ç–µ–≥–∏

## üì¶ –ú–æ–¥—É–ª–∏ –∏ –∏—Ö handlers

### 1. –ë–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å (`simple_amocrm_plugin.py`)
**6 handlers –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:**

- `amocrm_find_contact` - –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –ø–æ query
- `amocrm_create_contact` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ (name, phone, email)
- `amocrm_find_lead` - –ø–æ–∏—Å–∫ —Å–¥–µ–ª–∫–∏ –ø–æ query
- `amocrm_create_lead` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ (name, price, contact_id)
- `amocrm_add_note` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ –∫ —Å—É—â–Ω–æ—Å—Ç–∏
- `amocrm_search` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (contacts, leads)

### 2. –ú–æ–¥—É–ª—å –∫–æ–º–ø–∞–Ω–∏–π (`simple_amocrm_companies.py`)
**8 handlers –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏:**

- `amocrm_list_companies` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `amocrm_get_company` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ ID
- `amocrm_create_company` - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- `amocrm_update_company` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `amocrm_delete_company` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `amocrm_add_company_contact` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –∫ –∫–æ–º–ø–∞–Ω–∏–∏
- `amocrm_remove_company_contact` - –æ—Ç–≤—è–∑–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏
- `amocrm_get_company_contacts` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏

### 3. –ú–æ–¥—É–ª—å –∑–∞–¥–∞—á (`simple_amocrm_tasks.py`)
**8 handlers –¥–ª—è –∑–∞–¥–∞—á –∏ —Å–æ–±—ã—Ç–∏–π:**

- `amocrm_create_task` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ —Å—É—â–Ω–æ—Å—Ç–∏
- `amocrm_update_task` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- `amocrm_complete_task` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
- `amocrm_get_task` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–æ ID
- `amocrm_list_tasks` - —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `amocrm_delete_task` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- `amocrm_create_event` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
- `amocrm_list_events` - —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π

### 4. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–¥—É–ª—å (`simple_amocrm_advanced.py`)
**12 handlers –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**

**–í–µ–±—Ö—É–∫–∏:**
- `amocrm_list_webhooks` - —Å–ø–∏—Å–æ–∫ –≤–µ–±—Ö—É–∫–æ–≤
- `amocrm_create_webhook` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞
- `amocrm_update_webhook` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞
- `amocrm_delete_webhook` - —É–¥–∞–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞

**–í–∏–¥–∂–µ—Ç—ã:**
- `amocrm_list_widgets` - —Å–ø–∏—Å–æ–∫ –≤–∏–¥–∂–µ—Ç–æ–≤
- `amocrm_install_widget` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–∂–µ—Ç–∞
- `amocrm_uninstall_widget` - —É–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞

**–ó–≤–æ–Ω–∫–∏:**
- `amocrm_create_call` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –∑–≤–æ–Ω–∫–µ
- `amocrm_list_calls` - —Å–ø–∏—Å–æ–∫ –∑–≤–æ–Ω–∫–æ–≤

**–ö–∞—Ç–∞–ª–æ–≥–∏:**
- `amocrm_list_catalogs` - —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- `amocrm_create_catalog` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞
- `amocrm_list_catalog_elements` - —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞—Ç–∞–ª–æ–≥–∞
- `amocrm_create_catalog_element` - —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

### 5. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å (`simple_amocrm_admin.py`)
**14 handlers –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:**

**–í–æ—Ä–æ–Ω–∫–∏:**
- `amocrm_list_pipelines` - —Å–ø–∏—Å–æ–∫ –≤–æ—Ä–æ–Ω–æ–∫
- `amocrm_get_pipeline` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–æ—Ä–æ–Ω–∫–∏ –ø–æ ID
- `amocrm_create_pipeline` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–æ—Ä–æ–Ω–∫–∏
- `amocrm_update_pipeline` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–æ–Ω–∫–∏

**–°—Ç–∞—Ç—É—Å—ã:**
- `amocrm_list_statuses` - —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤–æ—Ä–æ–Ω–∫–∏
- `amocrm_create_status` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `amocrm_update_status` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
- `amocrm_list_users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `amocrm_get_user` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

**–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è:**
- `amocrm_list_custom_fields` - —Å–ø–∏—Å–æ–∫ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–æ–ª–µ–π
- `amocrm_create_custom_field` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–æ–ª—è
- `amocrm_update_custom_field` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–æ–ª—è

**–¢–µ–≥–∏:**
- `amocrm_list_tags` - —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤
- `amocrm_create_tag` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –ï–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–í—Å–µ –º–æ–¥—É–ª–∏ —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:
- –ù–∞—Å–ª–µ–¥—É—é—Ç –æ—Ç `BasePlugin`
- –î–µ–ª–µ–≥–∏—Ä—É—é—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –±–∞–∑–æ–≤–æ–º—É –ø–ª–∞–≥–∏–Ω—É —á–µ—Ä–µ–∑ `self.base_plugin`
- –ü–æ–ª—É—á–∞—é—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –±–∞–∑–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω –≤ `_do_initialize()`
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç–æ–¥—ã `_make_request()` –∏ `_resolve_value()` –±–∞–∑–æ–≤–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–ë–∞–∑–æ–≤—ã–π –ø–ª–∞–≥–∏–Ω** - HTTP –∫–ª–∏–µ–Ω—Ç, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü–∏–∏
- **–î–≤–∏–∂–æ–∫** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –í—Å–µ –ø–ª–∞–≥–∏–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ë–î –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –ú–µ—Ç–æ–¥ `_ensure_fresh_settings()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º
- –ù–ï –∫–µ—à–∏—Ä—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–∞–º—è—Ç–∏ –ø–ª–∞–≥–∏–Ω–∞

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ –º–æ–¥—É–ª–µ–π:** 5
- **–í—Å–µ–≥–æ handlers:** 48
- **–ü–æ–∫—Ä—ã—Ç–∏–µ API AmoCRM:** ~80% –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–†–∞–∑–º–µ—Ä –∫–æ–¥–∞:** ~2000 —Å—Ç—Ä–æ–∫ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ)

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í—Å–µ –º–æ–¥—É–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ –¥–≤–∏–∂–∫–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤–∏–∂–∫–∞ —Å –º–æ–¥—É–ª—è–º–∏ AmoCRM
engine = await create_engine()

# –í—Å–µ handlers –¥–æ—Å—Ç—É–ø–Ω—ã —Å—Ä–∞–∑—É
handlers = engine.get_registered_handlers()
amocrm_handlers = [h for h in handlers if h.startswith('amocrm_')]
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ MongoDB –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `agent_settings`:

```json
{
  "agent_id": "amocrm_agent",
  "settings": {
    "amocrm_subdomain": "your-subdomain",
    "amocrm_client_id": "your-client-id",
    "amocrm_client_secret": "your-client-secret",
    "amocrm_redirect_uri": "your-redirect-uri",
    "amocrm_access_token": "your-access-token",
    "amocrm_refresh_token": "your-refresh-token"
  }
}
```

## ‚úÖ –°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª–µ–π

- ‚úÖ **–ë–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å** - –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **–ú–æ–¥—É–ª—å –∫–æ–º–ø–∞–Ω–∏–π** - –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω  
- ‚úÖ **–ú–æ–¥—É–ª—å –∑–∞–¥–∞—á** - –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–¥—É–ª—å** - –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å** - –≥–æ—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω

–í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –¥–≤–∏–∂–∫–µ –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! 