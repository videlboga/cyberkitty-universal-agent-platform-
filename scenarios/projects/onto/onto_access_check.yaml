scenario_id: onto_access_check
description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ò–ò-–¥–∏–∞–ª–æ–≥ –ø—Ä–æ–¥–∞–∂"
version: "1.0"

steps:
  - id: start
    type: start
    next_step: load_user_data

  - id: load_user_data
    type: mongo_find_one_document
    params:
      collection: users
      filter:
        telegram_user_id: "{user_id}"
    next_step: check_access_level

  - id: check_access_level
    type: branch
    params:
      condition: "{mongo_result.access_level}"
      cases:
        "premium": grant_access
        "basic": offer_upgrade
        "trial": offer_trial_extension
      default_step: check_first_time

  - id: check_first_time
    type: branch
    params:
      condition: "{mongo_result.access_level}"
      true_step: offer_upgrade
      false_step: first_time_offer

  - id: grant_access
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        üåü –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–µ–º–∏—É–º –ø—Ä–æ–≥—Ä–∞–º–º—É, {mongo_result.name}!
        
        ‚úÖ –£ –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ —Ä–∞–∑–≤–∏—Ç–∏—è.
        
        üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–∞—à–µ–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ...
      parse_mode: HTML
    next_step: start_premium_program

  - id: start_premium_program
    type: switch_scenario
    params:
      scenario_id: onto_premium_program
      reason: "User has premium access"

  - id: first_time_offer
    type: action
    params:
      sales_prompt: |
        –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –¥–∞–Ω–Ω—ã—Ö:
        
        –ò–º—è: {mongo_result.name}
        –í–æ–∑—Ä–∞—Å—Ç: {mongo_result.age}
        –ü—Ä–æ—Ñ–µ—Å—Å–∏—è: {mongo_result.profession}
        –¶–µ–ª–∏: {mongo_result.goals}
        –í—ã–∑–æ–≤—ã: {mongo_result.challenges}
        –ú–æ—Ç–∏–≤–∞—Ü–∏—è: {mongo_result.motivation}
        –ò–ò –∞–Ω–∞–ª–∏–∑: {mongo_result.ai_analysis}
        
        –°–æ–∑–¥–∞–π –ø—Ä–æ–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è ONTO –∫–æ—É—á–∏–Ω–≥ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä–æ–µ:
        1. –û–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ –∏–º–µ–Ω–∏
        2. –°—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –µ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–µ–ª–∏ –∏ –≤—ã–∑–æ–≤—ã
        3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ—à–∏—Ç –∏–º–µ–Ω–Ω–æ –µ–≥–æ –ø—Ä–æ–±–ª–µ–º—ã
        4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
        5. –°–æ–∑–¥–∞–µ—Ç –æ—â—É—â–µ–Ω–∏–µ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏
        6. –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ü–µ–Ω—É –∏ —É—Å–ª–æ–≤–∏—è
        
        –¢–æ–Ω: –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π, —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–π, –Ω–æ –Ω–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π.
        –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –ø—Ä–æ–±–ª–µ–º–∞ -> —Ä–µ—à–µ–Ω–∏–µ -> –≤—ã–≥–æ–¥—ã -> –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ -> –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é
    next_step: generate_sales_message

  - id: generate_sales_message
    type: llm_query
    params:
      prompt: "{sales_prompt}"
      model: "gpt-4"
      max_tokens: 800
      temperature: 0.8
    next_step: send_personalized_offer

  - id: send_personalized_offer
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "{llm_response}"
      parse_mode: HTML
    next_step: show_pricing_options

  - id: show_pricing_options
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: "üíé –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:"
      buttons:
        - text: "üöÄ –ü–æ–ª–Ω—ã–π –∫—É—Ä—Å (15,000‚ÇΩ)"
          callback_data: "premium_full"
        - text: "üí´ –ë–∞–∑–æ–≤—ã–π (8,000‚ÇΩ)"
          callback_data: "premium_basic"
        - text: "üéØ –ü—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫ (500‚ÇΩ)"
          callback_data: "trial_lesson"
        - text: "‚ùì –í–æ–ø—Ä–æ—Å—ã"
          callback_data: "ask_questions"
        - text: "‚è∞ –ü–æ–¥—É–º–∞—é"
          callback_data: "think_later"
    next_step: wait_purchase_decision

  - id: offer_upgrade
    type: action
    params:
      upgrade_prompt: |
        –°–æ–∑–¥–∞–π —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è upgrade –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–∞–∑–æ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:
        
        –ò–º—è: {mongo_result.name}
        –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: {mongo_result.access_level}
        –ü—Ä–æ—Ñ–µ—Å—Å–∏—è: {mongo_result.profession}
        –¶–µ–ª–∏: {mongo_result.goals}
        –ü—Ä–æ–≥—Ä–µ—Å—Å: {mongo_result.progress_data}
        
        –ü–æ–∫–∞–∂–∏:
        1. –ß—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –¥–æ—Å—Ç–∏–≥ –Ω–∞ –±–∞–∑–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ
        2. –ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä–æ—é—Ç—Å—è —Å –ø—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø–æ–º
        3. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –µ–≥–æ —Ü–µ–ª–µ–π
        4. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ upgrade
        
        –¢–æ–Ω: –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è + –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π –Ω–∞ —Ä–æ—Å—Ç.
    next_step: generate_upgrade_message

  - id: generate_upgrade_message
    type: llm_query
    params:
      prompt: "{upgrade_prompt}"
      model: "gpt-4"
      max_tokens: 600
      temperature: 0.7
    next_step: send_upgrade_offer

  - id: send_upgrade_offer
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "{llm_response}"
      parse_mode: HTML
    next_step: show_upgrade_options

  - id: show_upgrade_options
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: "‚¨ÜÔ∏è –ì–æ—Ç–æ–≤—ã –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å?"
      buttons:
        - text: "üöÄ –î–∞, upgrade! (7,000‚ÇΩ)"
          callback_data: "upgrade_premium"
        - text: "üìä –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏—è"
          callback_data: "show_differences"
        - text: "üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"
          callback_data: "consultation"
        - text: "üîÑ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –±–∞–∑–æ–≤—ã–º"
          callback_data: "continue_basic"
    next_step: wait_upgrade_decision

  - id: offer_trial_extension
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        ‚è∞ {mongo_result.name}, –≤–∞—à –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫ –∫–æ–Ω—Ü—É!
        
        üìà –ó–∞ —ç—Ç–æ –≤—Ä–µ–º—è –≤—ã:
        ‚Ä¢ –ü—Ä–æ—à–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
        ‚Ä¢ –ü–æ–ª—É—á–∏–ª–∏ –ò–ò –∞–Ω–∞–ª–∏–∑ –ª–∏—á–Ω–æ—Å—Ç–∏
        ‚Ä¢ –ù–∞—á–∞–ª–∏ –ø–æ–Ω–∏–º–∞—Ç—å —Å–≤–æ–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        
        üéØ –ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω:
      parse_mode: HTML
    next_step: show_trial_options

  - id: show_trial_options
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: "üî• –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–±–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:"
      buttons:
        - text: "üíé –ü—Ä–µ–º–∏—É–º -20% (12,000‚ÇΩ)"
          callback_data: "trial_premium_discount"
        - text: "‚≠ê –ë–∞–∑–æ–≤—ã–π -15% (6,800‚ÇΩ)"
          callback_data: "trial_basic_discount"
        - text: "üìû –û–±—Å—É–¥–∏—Ç—å —É—Å–ª–æ–≤–∏—è"
          callback_data: "trial_consultation"
        - text: "‚ùå –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–±–Ω—ã–π"
          callback_data: "end_trial"
    next_step: wait_trial_decision

  - id: wait_purchase_decision
    type: input
    params:
      variable: purchase_choice
      validation: "required"
    next_step: process_purchase

  - id: wait_upgrade_decision
    type: input
    params:
      variable: upgrade_choice
      validation: "required"
    next_step: process_upgrade

  - id: wait_trial_decision
    type: input
    params:
      variable: trial_choice
      validation: "required"
    next_step: process_trial

  - id: process_purchase
    type: branch
    params:
      condition: "{purchase_choice}"
      cases:
        "premium_full": process_premium_purchase
        "premium_basic": process_basic_purchase
        "trial_lesson": process_trial_purchase
        "ask_questions": handle_questions
        "think_later": handle_postpone

  - id: process_upgrade
    type: branch
    params:
      condition: "{upgrade_choice}"
      cases:
        "upgrade_premium": process_premium_upgrade
        "show_differences": show_plan_differences
        "consultation": offer_consultation
        "continue_basic": continue_with_basic

  - id: process_trial
    type: branch
    params:
      condition: "{trial_choice}"
      cases:
        "trial_premium_discount": process_trial_premium
        "trial_basic_discount": process_trial_basic
        "trial_consultation": offer_trial_consultation
        "end_trial": end_trial_period

  - id: process_premium_purchase
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        üéâ –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä, {mongo_result.name}!
        
        üíé –ü—Ä–µ–º–∏—É–º –ø—Ä–æ–≥—Ä–∞–º–º–∞ ONTO –∫–æ—É—á–∏–Ω–≥ –≤–∫–ª—é—á–∞–µ—Ç:
        ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å –ò–ò
        ‚Ä¢ 12 –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏–π
        ‚Ä¢ –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
        ‚Ä¢ Telegram –ø–æ–¥–¥–µ—Ä–∂–∫—É 24/7
        ‚Ä¢ –ì–∞—Ä–∞–Ω—Ç–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        
        üí≥ –î–ª—è –æ–ø–ª–∞—Ç—ã 15,000‚ÇΩ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ:
        https://pay.onto.ru/premium/{user_id}
        
        üìû –í–æ–ø—Ä–æ—Å—ã? –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: @onto_support
      parse_mode: HTML
    next_step: save_purchase_intent

  - id: save_purchase_intent
    type: mongo_update_document
    params:
      collection: users
      filter:
        telegram_user_id: "{user_id}"
      document:
        purchase_intent: "premium_full"
        purchase_intent_date: "{current_timestamp}"
        purchase_amount: 15000
        purchase_status: "pending"
    next_step: create_amocrm_lead

  - id: create_amocrm_lead
    type: amocrm_create_lead
    params:
      name: "ONTO –ü—Ä–µ–º–∏—É–º - {mongo_result.name}"
      price: 15000
      contact_id: "{amocrm_contact_id}"
      pipeline_id: 1
      status_id: 1
    next_step: notify_sales_team

  - id: notify_sales_team
    type: amocrm_add_note
    params:
      entity_type: "lead"
      entity_id: "{amocrm_lead_id}"
      text: |
        üî• –ì–û–†–Ø–ß–ò–ô –õ–ò–î!
        
        –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—è–≤–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø—Ä–µ–º–∏—É–º –ø—Ä–æ–≥—Ä–∞–º–º–µ.
        –ò–ò –∞–Ω–∞–ª–∏–∑: {mongo_result.ai_analysis}
        
        –°–†–û–ß–ù–û —Å–≤—è–∑–∞—Ç—å—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 15 –º–∏–Ω—É—Ç!
      note_type: "common"
    next_step: schedule_followup

  - id: schedule_followup
    type: scheduler_create_task
    params:
      task_id: "followup_{user_id}"
      delay_seconds: 3600  # 1 —á–∞—Å
      scenario_id: "onto_payment_followup"
      context:
        user_id: "{user_id}"
        chat_id: "{chat_id}"
        purchase_type: "premium_full"
    next_step: end

  - id: handle_questions
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        ‚ùì –û—Ç–ª–∏—á–Ω–æ, {mongo_result.name}! –Ø –æ—Ç–≤–µ—á—É –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.
        
        ü§î –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?
        ‚Ä¢ –ö–∞–∫ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å–µ—Å—Å–∏–∏?
        ‚Ä¢ –ì–∞—Ä–∞–Ω—Ç–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞?
        ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—Ä–æ—á–∫–∏?
        ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã?
        
        –ó–∞–¥–∞–≤–∞–π—Ç–µ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã!
      parse_mode: HTML
    next_step: wait_question

  - id: wait_question
    type: input
    params:
      variable: user_question
      validation: "required"
    next_step: ai_answer_question

  - id: ai_answer_question
    type: llm_query
    params:
      prompt: |
        –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± ONTO –∫–æ—É—á–∏–Ω–≥ –ø—Ä–æ–≥—Ä–∞–º–º–µ:
        
        –í–æ–ø—Ä–æ—Å: {user_question}
        
        –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        –ò–º—è: {mongo_result.name}
        –¶–µ–ª–∏: {mongo_result.goals}
        –í—ã–∑–æ–≤—ã: {mongo_result.challenges}
        
        –î–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, –ø–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ –º—è–≥–∫–æ –ø–æ–¥–≤–µ–¥–∏ –∫ –ø–æ–∫—É–ø–∫–µ.
      model: "gpt-4"
      max_tokens: 400
    next_step: send_answer

  - id: send_answer
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: "{llm_response}"
      parse_mode: HTML
    next_step: ask_more_questions

  - id: ask_more_questions
    type: channel_action
    params:
      action: send_buttons
      chat_id: "{chat_id}"
      text: "–ï—Å—Ç—å –µ—â–µ –≤–æ–ø—Ä–æ—Å—ã?"
      buttons:
        - text: "‚ùì –ï—â–µ –≤–æ–ø—Ä–æ—Å"
          callback_data: "ask_questions"
        - text: "üíé –ì–æ—Ç–æ–≤ –∫ –ø–æ–∫—É–ø–∫–µ"
          callback_data: "ready_to_buy"
        - text: "üìû –õ–∏—á–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"
          callback_data: "consultation"
        - text: "‚è∞ –ü–æ–¥—É–º–∞—é"
          callback_data: "think_later"
    next_step: wait_next_action

  - id: wait_next_action
    type: input
    params:
      variable: next_action
      validation: "required"
    next_step: process_next_action

  - id: process_next_action
    type: branch
    params:
      condition: "{next_action}"
      cases:
        "ask_questions": handle_questions
        "ready_to_buy": show_pricing_options
        "consultation": offer_consultation
        "think_later": handle_postpone

  - id: handle_postpone
    type: channel_action
    params:
      action: send_message
      chat_id: "{chat_id}"
      text: |
        ‚è∞ –ü–æ–Ω–∏–º–∞—é, {mongo_result.name}! –í–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ–±–¥—É–º–∞—Ç—å.
        
        üí° –ü–æ–∫–∞ –≤—ã —Ä–∞–∑–º—ã—à–ª—è–µ—Ç–µ, –ø–æ–ª—É—á–∏—Ç–µ –±–æ–Ω—É—Å:
        üìñ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ "5 —à–∞–≥–æ–≤ –∫ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏"
        
        üìß –û—Ç–ø—Ä–∞–≤–∏–º –Ω–∞ email: https://onto.ru/bonus/{user_id}
        
        üì± –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã!
        –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.
      parse_mode: HTML
    next_step: schedule_reminder

  - id: schedule_reminder
    type: scheduler_create_task
    params:
      task_id: "reminder_{user_id}"
      delay_seconds: 172800  # 2 –¥–Ω—è
      scenario_id: "onto_purchase_reminder"
      context:
        user_id: "{user_id}"
        chat_id: "{chat_id}"
        reminder_type: "purchase_followup"
    next_step: end

  - id: end
    type: end 