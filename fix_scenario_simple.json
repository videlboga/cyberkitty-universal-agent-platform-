{
  "collection": "scenarios",
  "filter": {"scenario_id": "mr_ontobot_diagnostic_ya_ya"},
  "document": {
    "steps": [
      {
        "id": "start",
        "type": "start",
        "next_step": "send_ya_ya_video"
      },
      {
        "id": "send_ya_ya_video", 
        "type": "channel_action",
        "params": {
          "action": "copy_message",
          "chat_id": "{chat_id}",
          "from_chat_id": "-1002614708769",
          "message_id": 4,
          "disable_notification": true
        },
        "next_step": "show_ya_ya_options"
      },
      {
        "id": "show_ya_ya_options",
        "type": "channel_action", 
        "params": {
          "action": "send_message",
          "chat_id": "{chat_id}",
          "text": "üìù **–ü–æ—Å–ª–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:**",
          "reply_markup": {
            "inline_keyboard": [
              [{"text": "üëÅÔ∏è –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä—ã –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤", "callback_data": "view_ya_ya_examples"}],
              [{"text": "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã", "callback_data": "write_ya_ya_viruses"}]
            ]
          }
        },
        "next_step": "wait_for_ya_ya_choice"
      },
      {
        "id": "wait_for_ya_ya_choice",
        "type": "input",
        "params": {
          "waiting_for": "callback_query",
          "expected_values": ["view_ya_ya_examples", "write_ya_ya_viruses"]
        },
        "next_step": "process_choice"
      },
      {
        "id": "process_choice",
        "type": "branch",
        "params": {
          "conditions": [
            {"condition": "callback_data == \"view_ya_ya_examples\"", "next_step": "show_examples"},
            {"condition": "callback_data == \"write_ya_ya_viruses\"", "next_step": "provide_instructions"}
          ],
          "default_next_step": "show_examples"
        }
      },
      {
        "id": "show_examples",
        "type": "channel_action",
        "params": {
          "action": "send_message", 
          "chat_id": "{chat_id}",
          "text": "üìä **–ü—Ä–∏–º–µ—Ä—ã –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤ ¬´–Ø-–Ø¬ª:**\n\n‚Ä¢ \"–Ø –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–Ω—ã–π\"\n‚Ä¢ \"–Ø –Ω–µ –∑–∞—Å–ª—É–∂–∏–≤–∞—é —É—Å–ø–µ—Ö–∞\"\n‚Ä¢ \"–Ø –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞—é –æ—à–∏–±–∫–∏\"\n‚Ä¢ \"–Ø –Ω–µ –º–æ–≥—É –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å\"\n‚Ä¢ \"–Ø —Ö—É–∂–µ –¥—Ä—É–≥–∏—Ö\"\n‚Ä¢ \"–ú–Ω–µ –Ω–µ –≤–µ–∑–µ—Ç –≤ –∂–∏–∑–Ω–∏\"\n‚Ä¢ \"–Ø —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–π/–º–æ–ª–æ–¥–æ–π –¥–ª—è —ç—Ç–æ–≥–æ\"\n‚Ä¢ \"–£ –º–µ–Ω—è –Ω–µ—Ç —Ç–∞–ª–∞–Ω—Ç–∞\"\n\n–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–π –Ω–∞–π—Ç–∏ —Å–≤–æ–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã!",
          "reply_markup": {
            "inline_keyboard": [
              [{"text": "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –º—ã—Å–ª–µ–≤–∏—Ä—É—Å—ã", "callback_data": "write_ya_ya_viruses"}]
            ]
          }
        },
        "next_step": "wait_write_ya_ya"
      },
      {
        "id": "wait_write_ya_ya",
        "type": "input",
        "params": {
          "waiting_for": "callback_query",
          "expected_values": ["write_ya_ya_viruses"]
        },
        "next_step": "provide_instructions"
      },
      {
        "id": "provide_instructions",
        "type": "channel_action",
        "params": {
          "action": "send_message",
          "chat_id": "{chat_id}",
          "text": "üìù **–ó–∞–¥–∞–Ω–∏–µ ¬´–Ø-–Ø¬ª**\n\n–ù–∞–ø–∏—à–∏ 5-10 —Å–≤–æ–∏—Ö –º—ã—Å–ª–µ–≤–∏—Ä—É—Å–æ–≤ –æ —Å–µ–±–µ - –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —É–±–µ–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç —Ç–µ–±—è.\n\n–≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –º—ã—Å–ª–∏ –æ:\n‚Ä¢ –¢–≤–æ–∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è—Ö\n‚Ä¢ –í–Ω–µ—à–Ω–æ—Å—Ç–∏\n‚Ä¢ –•–∞—Ä–∞–∫—Ç–µ—Ä–µ\n‚Ä¢ –î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞—Ö/–Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞—Ö\n‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö\n\n–ë—É–¥—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–µ—Å—Ç–Ω—ã–º - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Ç–æ—á–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.\n\n–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –æ—Ç–≤–µ—Ç –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º:"
        },
        "next_step": "wait_for_response"
      },
      {
        "id": "wait_for_response",
        "type": "input",
        "params": {
          "waiting_for": "text",
          "timeout_seconds": 3600,
          "variable": "response_text"
        },
        "next_step": "save_ya_ya_response"
      },
      {
        "id": "save_ya_ya_response",
        "type": "mongo_upsert_document",
        "params": {
          "collection": "ontobot_responses",
          "filter": {"user_id": "{user_id}"},
          "document": {
            "user_id": "{user_id}",
            "chat_id": "{chat_id}",
            "response_type": "ya_ya",
            "response_text": "{response_text}",
            "completed_at": "{current_timestamp}"
          }
        },
        "next_step": "switch_to_ya_delo"
      },
      {
        "id": "switch_to_ya_delo",
        "type": "switch_scenario",
        "params": {
          "scenario_id": "mr_ontobot_diagnostic_ya_delo",
          "context": {
            "ya_ya_response": "{response_text}",
            "user_id": "{user_id}",
            "chat_id": "{chat_id}"
          }
        },
        "next_step": "end"
      },
      {
        "id": "end",
        "type": "end"
      }
    ]
  }
} 